(this["webpackJsonpjs-band-final-task"]=this["webpackJsonpjs-band-final-task"]||[]).push([[0],{44:function(e,t,n){e.exports=n(78)},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){e.exports=n.p+"static/media/notFound.f42d312b.jpg"},75:function(e,t,n){e.exports=n.p+"static/media/spinner.65ebb302.gif"},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(23),c=n.n(o),s=n(10),l=n(21),i=n(2),u=n(11),m=n.n(u),d=n(9),p=n.n(d),f=n(17),h=n(3),b=n(4),g=n(6),v=n(5),y=n(7),E=n(20);var O=Object(i.b)((function(e){return{countOfProducts:e.purchaseCard.countOfProducts}}),null)((function(e){var t=e.countOfProducts;return r.a.createElement("div",{className:"position-relative"},r.a.createElement("img",{style:{width:"50px"},src:"https://img.icons8.com/dotty/80/000000/shopping-basket.png",alt:"Basket",className:"mx-2"}),r.a.createElement("div",{className:"d-flex justify-content-center align-items-center position-absolute bg-success rounded-circle ",style:{width:"18px",height:"18px",fontSize:"12px",top:0,right:0}},t))}));function k(e){var t=e.name,n=e.text,a=e.handleClick,o=e.className,c=e.style,s=e.type;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:s,name:t,onClick:a,className:o,style:c},n))}k.defaultProps={className:"",style:{},type:"button"};var j=k,w=function(e){return{type:"SIGN_IN",payload:e}},x=function(){localStorage.removeItem("token"),localStorage.removeItem("username")},N=function(e,t){return!t.contains(e.target)},S=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(g.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).logOut=function(){(0,n.props.onSignOut)(),x()},n}return Object(y.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.avatar,n=e.username;return r.a.createElement("div",{className:"d-flex justify-content-between align-items-center p-4 border-bottom"},r.a.createElement("div",null,r.a.createElement(s.b,{to:"/books"},"JS Band store")," / Yarik Harmash"),r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement(s.b,{to:"/card"},r.a.createElement(O,null)),r.a.createElement(j,{handleClick:this.logOut,text:"Sign out",name:"signOut",className:"border rounded py-2 bg-light mx-2"}),r.a.createElement("img",{src:t,alt:"Avatar",className:"rounded-circle mx-2",style:{width:"40px"}}),r.a.createElement("h3",{className:"font-weight-bold mx-2"},n)))}}]),t}(a.Component),C=Object(i.b)((function(e){return{user:e.user}}),(function(e){return{onSignOut:function(){return e({type:"SIGN_OUT"})}}}))(S),P=n(8);function B(e){var t=e.label,n=e.placeholder,a=e.name,o=e.id,c=e.type,s=e.value,l=e.handleChanges,i=e.className,u=e.isError,m=e.errorText,d=e.handleKeyUp,p=e.min,f=e.max,h=e.handleBlur;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:o,className:"w-100 font-weight-bold d-flex align-items-center flex-column"},t||"",r.a.createElement("input",{type:c,id:o,className:i,name:a,value:s,onChange:function(e){return l(e)},onKeyUp:function(e){return d(e)},onBlur:function(e){return h(e)},placeholder:n,min:p,max:f}),u?r.a.createElement("span",{className:"text-danger font-weight-normal",style:{fontSize:"11px"}},m):null))}B.defaultProps={label:null,type:"text",className:"form-control",placeholder:null,isError:!1,errorText:"",handleKeyUp:function(){},handleBlur:function(){},min:"0",max:""};var A=B,L=(n(72),function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(g.a)(this,Object(v.a)(t).call(this))).checkValidation=function(){var t=e.state.username,n=t.length<4||t.length>16;return e.setState({isError:n}),n},e.handleKeyUp=function(t){13===t.keyCode&&e.logIn()},e.onInputChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(Object(P.a)({isError:!1},a,r))},e.logIn=Object(f.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.checkValidation()){t.next=3;break}return t.abrupt("return");case 3:return n=e.state.username,a=e.props.onSignIn,t.prev=5,t.next=8,m.a.post("signin",{username:n});case 8:r=t.sent,m.a.defaults.headers.common.Authorization="Bearer ".concat(r.data.token),a(r.data),e.setDataToLocalStorage(r.data),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(5),console.error("".concat(t.t0.name,": ").concat(t.t0.message));case 17:case"end":return t.stop()}}),t,null,[[5,14]])}))),e.setDataToLocalStorage=function(e){localStorage.setItem("token",e.token),localStorage.setItem("username",e.username)},e.state={username:"",isError:!1},e}return Object(y.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.isError;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"signin-wrapper position-absolute min-vh-100 min-vw-100"}),r.a.createElement("div",{className:" min-vh-100 min-vw-100 d-flex justify-content-center align-items-center position-relative"},r.a.createElement("div",{className:"signin-form w-25 d-flex justify-content-center align-items-center flex-column border border-dark px-4 py-3"},r.a.createElement(A,{value:t,name:"username",id:"username",className:"form-control m-2",label:"Username",isError:n,errorText:"Minimum 4, maximum 16 symbols",placeholder:"Enter your username...",handleChanges:this.onInputChange,handleKeyUp:this.handleKeyUp}),r.a.createElement(j,{handleClick:this.logIn,text:"Login",name:"login",className:"border rounded m-2 py-1 px-3"}))))}}]),t}(a.Component)),T=Object(i.b)(null,(function(e){return{onSignIn:function(t){return e(w(t))}}}))(L),D=n(43);function I(e){var t=e.name,n=e.optionList,a=e.label,o=e.disabledFirstElement,c=e.handleChanges,s=e.value,l=e.className;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"font-weight-bold "},a),r.a.createElement("select",{name:t,onChange:function(e){c(e)},className:l,value:s},n.map((function(e,t){return r.a.createElement("option",{disabled:o&&!t,key:e,value:e},e)}))))}I.defaultProps={label:null,className:"custom-select text-capitalize",disabledFirstElement:!1};var M=I,U=[{name:"All"},{name:"0 < price < 15",from:0,to:15},{name:"16 < price < 30",from:16,to:30},{name:"price > 31",from:31,to:1/0}];var _=Object(i.b)((function(e){return{filters:e.books.filters}}),(function(e){return{onSetFilter:function(t){return e(function(e){return{type:"SET_FILTER",payload:e}}(t))}}}))((function(e){var t=e.filters,n=e.onSetFilter;function a(e){var t=e.target,a=t.name,r=t.value;n({name:a,value:r})}return r.a.createElement("div",{className:"d-flex w-50 justify-content-start"},r.a.createElement("div",{className:"w-50 mr-3"},r.a.createElement(A,{value:t.search,name:"search",handleChanges:a,id:"search",placeholder:"Search by book name"})),r.a.createElement("div",{className:"w-50"},r.a.createElement(M,{value:t.price,optionList:U.map((function(e){return e.name})),name:"price",handleChanges:a})))}));var F=function(e){var t=e.book;return r.a.createElement("div",{className:"d-flex flex-column align-items-center justify-content-between p-2 border rounded m-3",style:{width:"20%"}},r.a.createElement("img",{src:t.cover,alt:"Book Cover",style:{height:"200px"}}),r.a.createElement("p",{className:"font-weight-bold align-self-start"},t.title),r.a.createElement("p",{className:"align-self-start"},t.author),r.a.createElement("div",{className:"w-100 d-flex justify-content-between align-items-center mt-5"},r.a.createElement("p",{className:"font-weight-bold"},t.price," $"),r.a.createElement(s.b,{to:"/books/".concat(t.id)},r.a.createElement(j,{handleClick:function(){},text:"View Details",name:"viewDetails",className:"border rounded p-2 bg-light"}))))},K=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(g.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).makeSearch=function(e){var t=n.props.filters.search;return e.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}))},n.makeFilter=function(e){var t=n.props.filters.price;if("all"===t.toLowerCase())return e;var a=U.find((function(e){return e.name===t}));return e.filter((function(e){return e.price>=a.from&&e.price<=a.to}))},n.makeBooksList=function(){var e=n.props,t=e.booksList,a=e.filters,r=a.search,o=a.price,c=t;return r&&(c=n.makeSearch(c)),o&&(c=n.makeFilter(c)),c},n}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.onSaveBooksList,e.prev=1,e.next=4,m.a.get("books");case 4:n=e.sent,t(n.data),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),"Unauthorized"===e.t0.response.data.message&&(a=this.props.history,x(),a.push("/signin")),console.error("".concat(e.t0.name,": ").concat(e.t0.message));case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"d-flex flex-wrap justify-content-center"},this.makeBooksList().map((function(e){return r.a.createElement(F,{book:e,key:e.id})})))}}]),t}(a.Component),z=Object(i.b)((function(e){return{booksList:e.books.booksList,filters:e.books.filters}}),(function(e){return{onSaveBooksList:function(t){return e(function(e){return{type:"SAVE_BOOK_LIST",payload:e}}(t))}}}))(K);var R=function(e){var t=Object(D.a)({},e);return r.a.createElement("div",{className:"p-4"},r.a.createElement(_,null),r.a.createElement(z,t))};var G=function(e){var t=e.currentBook;return r.a.createElement("div",{className:"w-75 h-100"},r.a.createElement("div",{className:"d-flex h-100"},r.a.createElement("div",{className:"d-flex w-50 border rounded justify-content-center align-items-center p-2 mr-2"},r.a.createElement("img",{src:t.cover,alt:"Book Cover"})),r.a.createElement("div",null,r.a.createElement("h3",{className:"font-weight-bold mb-2 ml-2 mr-2",style:{fontSize:"18px"}},t.title),r.a.createElement("p",{className:"m-2"},r.a.createElement("span",{className:"font-weight-bold"},"Author: "),t.author),r.a.createElement("p",{className:"m-2"},r.a.createElement("span",{className:"font-weight-bold"},"Level: "),t.level),r.a.createElement("p",{className:"m-2"},r.a.createElement("span",{className:"font-weight-bold"},"Tags: "),t.tags&&t.tags.map((function(e){return"".concat(e,"; ")}))))),r.a.createElement("p",{className:"mt-4"},t.description))},V=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(g.a)(this,Object(v.a)(t).call(this))).checkTheNumberOfAvailableBook=function(){var t=e.props,n=t.basket,a=t.currentBook,r=a.count;return n.length?(n.forEach((function(e){e.item.id===a.id&&(r-=e.count)})),r):r},e.handleChanges=function(t){var n,a,r=t.target,o=r.name,c=r.value;c>e.checkTheNumberOfAvailableBook()?e.setState((n={},Object(P.a)(n,o,String(e.checkTheNumberOfAvailableBook())),Object(P.a)(n,"isWarningShown",!0),n)):e.setState((a={},Object(P.a)(a,o,c),Object(P.a)(a,"isWarningShown",!1),a))},e.handleBlur=function(){e.setState({isWarningShown:!1})},e.clearState=function(){e.setState({count:"0"})},e.handleClick=function(){var t=e.props,n=t.onAddItemToCard,a=t.currentBook,r=t.toggleModal,o=e.state.count;"0"!==o&&(n({item:a,count:o}),e.clearState(),r())},e.state={count:"0",isWarningShown:!1},e}return Object(y.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.currentBook,t=this.state,n=t.count,a=t.isWarningShown;return r.a.createElement("div",{className:"w-25 border rounded p-3 h-50 font-weight-bold"},r.a.createElement("div",{className:"d-flex justify-content-between mb-2"},r.a.createElement("p",null,"Price, $")," ",r.a.createElement("p",null,e.price)),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-2"},r.a.createElement("p",null,"Count"),r.a.createElement("div",{className:"w-25"},r.a.createElement(A,{value:n,name:"count",handleChanges:this.handleChanges,handleBlur:this.handleBlur,id:"count",type:"number",max:String(this.checkTheNumberOfAvailableBook())}))),r.a.createElement("p",{className:"w-100 text-warning text-right ".concat(a?"d-flex":"d-none"),style:{fontSize:"12px"}},"Sorry! There are only ",this.checkTheNumberOfAvailableBook()," books available :("),r.a.createElement("div",{className:"d-flex justify-content-between mb-2"},r.a.createElement("p",null,"Total Price"),r.a.createElement("p",null,(e.price*n).toFixed(2))),r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(j,{handleClick:this.handleClick,text:"Add to card",name:"addToCard",className:"border rounded p-2 bg-light"})))}}]),t}(a.Component),W=Object(i.b)((function(e){return{basket:e.purchaseCard.basket}}),(function(e){return{onAddItemToCard:function(t){return e(function(e){return{type:"ADD_ITEM_TO_CARD",payload:e}}(t))}}}))(V),J=(n(73),function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(g.a)(this,Object(v.a)(t).call(this))).handleOutsideClick=function(t){var n=e.props.closeModal;N(t,e.modal)&&n()},e.modal=r.a.createRef(),e}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.modal.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.modalTitle,a=t.children,o=t.handleKeyUp;return r.a.createElement("div",{className:"modal-wrapper d-flex vw-100 vh-100 position-fixed overflow-auto justify-content-center align-items-center",onClick:function(t){return e.handleOutsideClick(t)}},r.a.createElement("div",{className:"base-modal d-flex flex-column align-items-center justify-content-center rounded p-4",ref:function(t){e.modal=t},tabIndex:"0",onKeyDown:function(e){return o(e)}},r.a.createElement("h2",{className:"modal-title font-weight-bold text-center"},n),a))}}]),t}(a.Component));J.defaultProps={modalTitle:"",children:null};var $=J;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach((function(t){Object(P.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(g.a)(this,Object(v.a)(t).call(this))).getCurrentBook=Object(f.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.match,t.prev=1,t.next=4,m.a.get("books/".concat(n.params.id));case 4:a=t.sent,e.setState({currentBook:a.data}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=e.props.history,404===t.t0.response.status?r.push("/not-found"):"Unauthorized"===t.t0.response.data.message?(x(),r.push("/signin")):console.error("".concat(t.t0.name,": ").concat(t.t0.message));case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),e.setCurrentBook=function(){var t=e.props,n=t.match,a=t.booksList,r=t.history;if(a.length){var o=a.filter((function(e){return e.id===n.params.id}));o.length||r.push("/not-found"),e.setState({currentBook:Y({},o[0])})}else e.getCurrentBook()},e.toggleModal=function(){e.setState((function(e){return{isModalShown:!e.isModalShown}}))},e.closeModal=function(){e.setState({isModalShown:!1})},e.handleKeyUp=function(t){27!==t.keyCode&&13!==t.keyCode||e.closeModal()},e.state={currentBook:null,isModalShown:!1},e}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.booksList.length?this.setCurrentBook():this.getCurrentBook()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match,a=t.booksList,r=this.state.currentBook;a.length||r?e.match.params.id!==n.params.id&&this.setCurrentBook():this.getCurrentBook()}},{key:"render",value:function(){var e=this.state,t=e.currentBook,n=e.isModalShown;return r.a.createElement("div",{className:"d-flex w-100 p-5"},t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{currentBook:t}),r.a.createElement(W,{currentBook:t,toggleModal:this.toggleModal}),n&&r.a.createElement($,{modalTitle:"Thank you for your order!",handleKeyUp:this.handleKeyUp,closeModal:this.closeModal},r.a.createElement("p",{className:"text-center my-4"},"The book has been successfully added to the cart"),r.a.createElement(j,{handleClick:this.toggleModal,text:"Continue shopping",name:"continueShopping",className:"border rounded p-2 text-success font-weight-bold"}))))}}]),t}(a.Component),Q=Object(i.b)((function(e){return{booksList:e.books.booksList}}),null)(q);var X=function(){return r.a.createElement("div",{style:{minHeight:"calc(100vh - 100px)"},className:"d-flex flex-column justify-content-center align-items-center"},r.a.createElement("h3",null,"The card is empty :("),r.a.createElement("img",{src:"https://img.icons8.com/dotty/80/000000/shopping-basket.png",alt:"Basket icon"}))};var Z=function(e){var t=e.basketItem;return r.a.createElement("div",{className:"d-flex justify-content-between align-items-center p-3 border rounded my-1"},r.a.createElement("div",{className:"d-flex align-items-center justify-content-between"},r.a.createElement("h3",{className:"mr-5 font-weight-bold"},t.item.title),r.a.createElement("p",null,t.count," items")),r.a.createElement("p",null,"Total price: ",t.item.price*t.count," $"))};var ee=function(e){var t=e.basket;return r.a.createElement("div",{className:"d-flex flex-column"},t.map((function(e){return r.a.createElement(Z,{basketItem:e,key:e.item.id})})),r.a.createElement("p",{className:"align-self-end font-weight-bold pr-3 my-3"},"Total price: ",function(){var e=0;return t.forEach((function(t){e+=t.count*t.item.price})),e.toFixed(2)}(),"$"))},te=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(g.a)(this,Object(v.a)(t).call(this))).handleClick=Object(f.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.onClearCard,a=e.formatDataBeforeSend(),t.prev=2,t.next=5,m.a.post("purchase",{books:a});case 5:n(),e.toggleModal(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),"Unauthorized"===t.t0.response.data.message?(r=e.props.history,x(),r.push("/signin")):console.error("".concat(t.t0.name,": ").concat(t.t0.message));case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),e.formatDataBeforeSend=function(){var t=e.props.basket,n=[];return t.forEach((function(e){for(var t=0;t<e.count;t++)n.push(e.item.id)})),n},e.toggleModal=function(){e.setState((function(e){return{isModalShown:!e.isModalShown}}))},e.closeModal=function(){e.setState({isModalShown:!1})},e.handleKeyUp=function(t){27!==t.keyCode&&13!==t.keyCode||e.closeModal()},e.state={isModalShown:!1},e}return Object(y.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.state.isModalShown,t=this.props,n=t.countOfProducts,a=t.basket;return r.a.createElement("div",null,n?r.a.createElement("div",{className:"d-flex flex-column px-5"},r.a.createElement(j,{handleClick:this.handleClick,text:"Purchase",name:"purchase",className:"border rounded bg-success p-2 align-self-end my-2",style:{width:"150px"}}),r.a.createElement(ee,{basket:a})):r.a.createElement(X,null),e&&r.a.createElement($,{modalTitle:"Thank you for your order!",handleKeyUp:this.handleKeyUp,closeModal:this.closeModal},r.a.createElement("p",{className:"text-center my-4"},"The order was successfully sent."),r.a.createElement(s.b,{to:"/books"},r.a.createElement(j,{handleClick:this.toggleModal,text:"Continue shopping",name:"continueShopping",className:"border rounded p-2 text-success font-weight-bold"}))))}}]),t}(a.Component),ne=Object(i.b)((function(e){return{countOfProducts:e.purchaseCard.countOfProducts,basket:e.purchaseCard.basket}}),(function(e){return{onClearCard:function(){return e({type:"CLEAR_CARD"})}}}))(te);var ae=function(){return r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("img",{src:n(74),alt:"Not Found",className:"mt-5"}))},re=function(){return r.a.createElement("div",{className:"min-vh-100 min-vw-100 position-absolute d-flex justify-content-center align-items-center",style:{top:0}},r.a.createElement("img",{src:n(75),alt:"Spinner"}))};var oe=function(){return r.a.createElement("div",{className:"position-absolute fixed-bottom text-center"},r.a.createElement("span",null,r.a.createElement("code",null,r.a.createElement(s.b,{to:"/books"},"JS Band store "),"created by ",r.a.createElement("a",{href:"https://github.com/feroxes/"},"Yarik Harmash"))))},ce=n(26),se=Object(i.b)((function(e){return{isAuthenticated:e.user.isAuthenticated}}),null)((function(e){var t=e.component,n=e.restricted,a=e.isAuthenticated,o=Object(ce.a)(e,["component","restricted","isAuthenticated"]);return r.a.createElement(E.b,Object.assign({},o,{render:function(e){return a&&n?r.a.createElement(E.a,{to:"/books"}):r.a.createElement(t,e)}}))})),le=Object(i.b)((function(e){return{isAuthenticated:e.user.isAuthenticated}}),null)((function(e){var t=e.component,n=e.isAuthenticated,a=e.path,o=Object(ce.a)(e,["component","isAuthenticated","path"]);return"/"!==a||n?"/"===a&&n?r.a.createElement(E.b,o,r.a.createElement(E.a,{to:"/books"})):r.a.createElement(E.b,Object.assign({},o,{render:function(e){return n?r.a.createElement(t,e):r.a.createElement(E.a,{to:"/signin"})}})):r.a.createElement(E.b,o,r.a.createElement(E.a,{to:"/signin"}))})),ie=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(g.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).getProfile=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.onSignIn,(0,a.onSetLoading)(!0),e.prev=2,e.next=5,m.a.post("signin",{username:t});case 5:o=e.sent,r(o.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("".concat(e.t0.name,": ").concat(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),n}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onSetLoading,t=localStorage.getItem("token"),n=localStorage.getItem("username");t&&n?this.getProfile(n):e(!1)}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.isLoading;return r.a.createElement("div",{className:"position-relative min-vh-100"},t&&r.a.createElement(C,null),null===n||n?r.a.createElement(re,null):r.a.createElement(E.d,null,r.a.createElement(le,{component:{},path:"/",exact:!0}),r.a.createElement(se,{component:T,path:"/signin",exact:!0,restricted:!0}),r.a.createElement(le,{component:R,path:"/books",exact:!0}),r.a.createElement(le,{component:Q,path:"/books/:id",exact:!0}),r.a.createElement(le,{component:ne,path:"/card",exact:!0}),r.a.createElement(se,{component:ae,restricted:!1})),r.a.createElement(oe,null))}}]),t}(a.Component);ie.defaultProps={isLoading:null};var ue=Object(i.b)((function(e){return{isAuthenticated:e.user.isAuthenticated,isLoading:e.user.isLoading}}),(function(e){return{onSignIn:function(t){return e(w(t))},onSetLoading:function(t){return e(function(e){return{type:"SET_LOADING",payload:e}}(t))}}}))(ie);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(n,!0).forEach((function(t){Object(P.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe={username:"",avatar:"",isAuthenticated:!1,isLoading:null},fe=n(25);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(n,!0).forEach((function(t){Object(P.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge={countOfProducts:0,basket:[]};function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach((function(t){Object(P.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee={booksList:[],filters:{search:"",price:""}},Oe=Object(l.b)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"SET_LOADING":return de({},e,{isLoading:a});case"SIGN_IN":return de({},e,{username:a.username,avatar:a.avatar,isAuthenticated:!0,isLoading:!1});case"SIGN_OUT":return de({},e,{username:"",avatar:"",isAuthenticated:!1});default:return e}},purchaseCard:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"ADD_ITEM_TO_CARD":return be({},e,{basket:[].concat(Object(fe.a)(e.basket),[a]),countOfProducts:e.countOfProducts+Number(a.count)});case"CLEAR_CARD":return be({},e,{basket:[],countOfProducts:0});default:return e}},books:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"SAVE_BOOK_LIST":return ye({},e,{booksList:Object(fe.a)(a)});case"SET_FILTER":return ye({},e,{filters:ye({},e.filters,Object(P.a)({},a.name,a.value))});default:return e}}});n(76),n(77);m.a.defaults.baseURL="https://js-band-api.glitch.me/";var ke=localStorage.getItem("token");ke&&(m.a.defaults.headers.common.Authorization="Bearer ".concat(ke));var je=Object(l.c)(Oe);c.a.render(r.a.createElement(i.a,{store:je},r.a.createElement(s.a,null,r.a.createElement(ue,null))),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.e5f7b83c.chunk.js.map